<p id="notice"><%= notice %></p>

<h1><%= Book.model_name.human %></h1>

<table>
  <thead>
    <tr>
      <th><%= Book.human_attribute_name(:title) %></th>
      <th><%= Book.human_attribute_name(:memo) %></th>
      <th><%= Book.human_attribute_name(:author) %></th>
      <th><%= Book.human_attribute_name(:picture) %></th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @books.each do |book| %>
      <tr>
        <td><%= book.title %></td>
        <td><%= book.memo %></td>
        <td><%= book.author %></td>
        <td><%= book.picture %></td>
        <td><%= link_to t('views.common.show'), book %></td>
        <td><%= link_to t('views.common.edit'), edit_book_path(book) %></td>
        <td><%= link_to t('views.common.destroy'), book, method: :delete, data: { confirm: t('views.common.delete_confirm') } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>
<% current_page = Book.page(params[:page]) %>
<% current_page_num = params[:page].to_i %>
<% displayed_pages_num = 5; window_size = 2; last_page_num = current_page.total_pages %>

<% if current_page.out_of_range? || current_page_num <= 0 %>
   <%= paginate @books %> 
<%#[1] 2 3 4 5 ... %>
<%#1 [2] 3 4 5 ... %>
<% elsif current_page_num - 1 < window_size %>
 <%= paginate @books, window: displayed_pages_num - current_page_num %> 
<%# ... 5 6 7 8 [9] %>
<%# ... 5 6 7 [8] 9 %>
<% elsif (last_page_num - current_page_num) < window_size  %>
 <%= paginate @books, window: displayed_pages_num - (last_page_num - current_page_num + 1) %> 
<%# ...3 4 [5] 6 7 ... %>
<%#1 2 3 [4] 5 6 ... <] [>現在ページから左にwindow_size分移動したページが2ページの場合、1ページも表示される%>
<%# ...4 5 [6] 7 8 9 [>現在ページから右にwindow_size分移動したページが最終ページ直前の場合、最終ページも表示される%>
<% else %>
 <%= paginate @books, window: window_size %> 
<% end %>
<%= link_to t('views.common.new'), new_book_path %>
